<!DOCTYPE html>
<html lang = "en">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/main.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="css/vanGoghd3.css" type="text/css" charset="utf-8">

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400|Playfair+Display:400,700" rel="stylesheet">

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="libraries/lodash.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
      integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
      crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
      integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
      crossorigin=""></script>
    <!-- Mapbox -->
    <link rel="stylesheet" type="text/css" href="https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.css" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.js"></script>
    <!-- Colors -->
    <script src='libraries/vibrant.min.js'></script>
    <!--Tween-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script>

    <script>
      // let filePath = '../assets/' // Local Testing
      let filePath = '/ms1-2018/interactivity/assets/' // GitHub Pages
      let paintingSelection = 436524;
      function distance(lat1, lon1, lat2, lon2, unit) {
      	let radlat1 = Math.PI * lat1/180
      	let radlat2 = Math.PI * lat2/180
      	let theta = lon1-lon2
      	let radtheta = Math.PI * theta/180
      	let dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
      	dist = Math.acos(dist)
      	dist = dist * 180/Math.PI
      	dist = dist * 60 * 1.1515
      	if (unit=="K") { dist = dist * 1.609344 }
      	if (unit=="N") { dist = dist * 0.8684 }
      	return dist
      }
      function getRandomInt(max,min) {
        return Math.floor(Math.random() * max) + min;
      }
    </script>
  </head>
  <body>
    <div id = 'scroll'>
      <!-- graphic container -->
      <div class='scroll__graphic graphic'>
        <!-- actual graphic/chart -->
        <div id = 'vanGoghd3-svg' class = 'chart'>
          <div id = 'project-title'>
            <div id = "title-text">
              <h1>The<br>Migration<br>of&nbsp;&nbsp;Art</h1>
            </div>
          </div>
        </div>
      </div>

        <!-- step/text container -->
      <div id = 'vanGoghd3-intro' class = 'scroll__text'>
        <div class = 'step' data-step='1' id = "step-1">
          <!-- <hr> -->
          <!-- <h1><span>&nbsp;The&nbsp;<span></h1>
          <h1><span>&nbsp;Migration&nbsp;<span></h1>
          <h1><span>&nbsp;of&nbsp;&nbsp;Art&nbsp;<span></h1> -->
        </div>
        <!-- <hr class = "whitespace" style = "height:60vh"/> -->
        <div class = 'step' data-step='2' id = "step-2">
          <hr class = "whitespace" style = "height:50vh"/>
          <div id = 'sticky-title'>
            <script>
            let mapButtonVar = false;
            let moreInfoVar  = false;
            function mapButton() {
              if (mapButtonVar) {
                // The map is already showing, so hide it
                mapButtonVar = false;
                let map = d3.select("#map");
                map.transition()
                   .ease(d3.easeQuadInOut)
                    .duration(1000)
                    .style("top","106vh")
                d3.select("#map-button").text("Show Map")
              } else {
                // The map is hidden, so show it
                mapButtonVar = true;
                let map = d3.select("#map");
                map.transition()
                   .ease(d3.easeQuadInOut)
                    .duration(1000)
                    .style("top","6vh");
                d3.select("#map-button").text("Hide Map")
              }
            }
            function moreInfoButton() {
              if (moreInfoVar) {
                // Info is already showing, so hide it
                moreInfoVar = false;
                let intro = d3.select("#intro-text");
                intro.transition()
                     .ease(d3.easeQuadInOut)
                      .duration(1000)
                      .style("top","106vh");
                d3.select("#more-info-button").text("More Info")
              } else {
                moreInfoVar = true;
                // Intro is hidden, so show it
                let intro = d3.select("#intro-text");
                intro.transition()
                     .ease(d3.easeQuadInOut)
                      .duration(1000)
                      .style("top","6vh");
                d3.select("#more-info-button").text("Hide Info")
              }
            }
            </script>
            <h1>The Migration of Art</h1>
            <button id = "map-button" onclick = "mapButton()">
              Show Map
            </button>
            <button id = "more-info-button" onclick = "moreInfoButton()">
              More Info
            </button>
            <hr class = "whitespace" style = "width:60vw;"/>
          </div>
          <div class = "marey" id = "marey">
            <!-- <div id = "marey-explanation">
              <h1>THIS IS THE MAREY EXPLANATION DIV</h1>
            </div> -->
            <div id = "marey-legend">
              <h3>Travel Timeline</h3>
              <h1>Sunflowers</h1>
              <hr>
              <h2>When and where did this painting travel across the globe?</h2>
              <p>Inspried by E.J. Marey's 1885 graphical <a href = "https://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003zP">train schedule,</a> this visualization shows the path traveled by a select painting from its creation until 2017.
                Every location visited by at least one painting in this collection is represented by a horizontal line, arranged from East (top) to West (bottom). Each painting has a separate path with these shared axes - use the menu on the righthand side to change paintings. A painting's path will travel to a new location in a year when a new owner acquires that piece or when it goes on exhibition.</p>
              <hr>
              <h2>Legend</h2>
              <!-- <span style="color:#DAA520;background-color:rgba(0,0,0,0)">exhibitions</span> by circles: -->
              <svg height="15vh" width="100%" id="ownership-demo">
                <!-- <rect height="15vh" width="100%" style = "fill:#afafaf"></rect> -->
                <!-- Legend Line -->
                <line x1="40%" y1="20%" x2="50%" y2="80%" class = "legend-line"></line>
                <!-- Individual Owners -->
                <line x1="0%" y1="20%" x2="40%" y2="20%" class = "owner-line"></line>
                <line x1="50%" y1="80%" x2="100%" y2="80%" class = "owner-line"></line>
                <text x="2%" y="60%" class = "owner-text">Individual Owners</text>
                <line x1="29%" y1="50%" x2="35%" y2="25%" class = "owner-line-callout"></line>
                <line x1="29%" y1="65%" x2="48%" y2="80%" class = "owner-line-callout"></line>

                <!-- Exhibitions -->
                <circle cx="75%" cy="80%" r="6" fill="none" stroke-width="2" class = "exhib-legend-circle"></circle>
                <circle cx="95%" cy="80%" r="6" fill="none" stroke-width="2" class = "exhib-legend-circle"></circle>
                <text x="85%" y="50%" style="fill:#fff;text-anchor:middle;">Exhibitions</text>
                <line x1="77%" y1="70%" x2="80%" y2="55%" style="stroke:#afafaf;stroke-width:1;stroke-dasharray:2;"></line>
                <line x1="93%" y1="70%" x2="90%" y2="55%" style="stroke:#afafaf;stroke-width:1;stroke-dasharray:2;"></line>

              </svg>
              <p>This example painting had two individual owners and went on two exhibitions across two distinct locations in the time span shown.</p>
            </div>
            <div id = "marey-chart">
            </div>
            <div id = "year-hover-text">
              <h2>2017</h2>
              <h1>Owner Name <span id="owner-location">(Owner Location)</span></h1>
              <p>Exhibition 1 <span id="exhib-location">(Exhib Location)</span></p>
            </div>
          </div>
          <div id = 'map'>
            <link rel="stylesheet" href="css/map.css" type="text/css" charset="utf-8">
            <script src="js/mapAllPaths.js"></script>
          </div>
          <div id = "slidecontainer">
            <link rel="stylesheet" href="css/slider.css" type="text/css" charset="utf-8">
            <!-- <div id = "slider-buttons">
              <script>
              let mapButtonVar      = false;
              function mapButton() {
                if (mapButtonVar) {
                  // The map is already showing, so hide it
                  mapButtonVar = false;
                  let map = d3.select("#map");
                  map.transition()
                     .ease(d3.easeQuadInOut)
                      .duration(1000)
                      .style("top","105vh")
                  d3.select("#map-button").text("Show Map")
                } else {
                  // The map is hidden, so show it
                  mapButtonVar = true;
                  let map = d3.select("#map");
                  map.transition()
                     .ease(d3.easeQuadInOut)
                      .duration(1000)
                      .style("top","6vh");
                  d3.select("#map-button").text("Hide Map")
                }
              }
              function moreInfoButton() {
                let intro = d3.select("#intro-text");
                intro.transition()
                     .ease(d3.easeQuadInOut)
                      .duration(1000)
                      .style("top","6vh");
              }
              </script>
              <button id = "more-info-button" onclick = "moreInfoButton()">
                More Info
              </button>
              <button id = "map-button" onclick = "mapButton()">
                Show Map
              </button>
            </div> -->
            <hr class = "whitespace" style = "width:24vw;"/>
            <div id = "slider">
              <p id = "slideyear"><b>2017</b></p>
              <input type="range" class="year-slider" id="year-slider">
              <svg id = "slider-year-axis" width = "100%"></svg>
            </div>
          </div>
          <!-- <hr class = "whitespace" style = "height:20vh"/> -->
          </div>
          <div id = 'intro-text'>
            <h1>Exploring Art's History of Movement</h1>
            <h2>Vincent Van Gogh at <i>The Met</i>, 1885-2017</h2>
            <!-- <br> -->
            <p>
              When we visit a renowned piece of art in a museum's galleries, we may not always consider the path it traveled before arriving at this destination.
              Prominent artwork can be bought, sold, traded, and put on display across the far reaches of our world - or it can be hidden away in a private collection or in storage.
              Studying this history of movement can help us understand how the world has interacted with a specific piece of art, giving us clues to its cultural impact and influence on regions, eras, and movements in the broader artistic context.
            </p>
            <p>
              Vincent Van Gogh created hundreds of paintings in his troubled life, and although he would not enjoy the success of his work during his lifetime, his work has been profoundly influential in Western art.
              The Met has 18 of his masterpiece landscapes, portraits, and still lifes in their collection. In <i>The Migration of Art,</i> we explore how these paintings traversed the globe, unearthing each nook and cranny of its travels through ownership changes and exhibitions.
              Inspired by E.J. Marey's 1885 graphical <a href = "https://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003zP">train schedule,</a> this visualization shows a detailed timeline of movement for each of Van Gogh's paintings within The Met's collection.
              These paths, which approximate the real movement of each painting across the globe, change location when a painting changes hands or when it goes on exhibition - after its last exhibition on record, it returns to the Met.
              Hover over this view to see detailed information on the owners and exhibitions during each year of the painting's journey, or show the map to see this painting's movement in real time.
          </div>
        </div>
    </div>

    <script src="js/vanGoghd3.js"></script>
    <script src="js/graphic.js"></script>

    <script src="js/graph-scroll.js"></script>

    <script>
    // createGraphic('.graphic')
    (function() {
      function graphscroll() {
        // select elements using d3 here since this is a d3 library...
        let graphicEl = d3.select("#scroll");
        let graphicVisEl = graphicEl.select(".scroll__graphic");
        var triggerEls = graphicEl.selectAll('.step');
        // viewport height
				var viewportHeight = window.innerHeight
				var halfViewportHeight = viewportHeight / 2
				// a global function creates and handles all the vis + updates
				var graphic = createGraphic('.graphic')
        // this is it, graph-scroll handles pretty much everything
        // it will automatically add class names to the elements,
        // so you just need to handle the fixed positions with css
        d3.graphScroll()
          .container(graphicEl)
          .graph(graphicVisEl)
          .sections(triggerEls)
          .offset(viewportHeight*0.8)
          .on('active', function(i) {
            graphic.update(i);
          })
      }
      graphscroll();
    })()
    </script>
    <!-- <div id = "distSmallMults">
      <script src="js/smallMultiplesTotalDistance.js"></script>
    </div> -->
    <script src = "js/distanceMarey.js"></script>
  </body>
</html>
